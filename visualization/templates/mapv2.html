<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.js"> </script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js'></script>

</head>

<style>
path.link {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

circle {
  fill: #ccc;
  stroke: #fff;
  stroke-width: 1.5px;
}

text {
  fill: #000;
  font: 10px sans-serif;
  pointer-events: none;
}
</style>

<script>
var categories = {"blaya": {"0": 0.8182555007165965, "1": 0.08549706332372908, "2": 0.5935548877053447, "3": 0.7712086794020022, "4": 0.40114647167785267, "5": 			   0.808217754894103, "6": 0.5922193757007699, "7": 0.9210782584598755, "8": 0.9420346323178553, "9": 0.5642281691912425}, 
			 "blake": {"0": 0.20708549176684765, "1": 0.5353099660400175, "2": 0.055618391377942666, "3": 0.2726501775024006, "4": 0.3324891571953835, "5": 0.09648335702061528, "6": 0.7790670896434639, "7": 0.8597396399958576, "8": 0.5648914825427691, "9": 0.9664499826593653}, 
			 "alvin": {"0": 0.07999152385734765, "1": 0.3141322544505253, "2": 0.7106876773173211, "3": 0.9783681204600595, "4": 0.7418471585133476, "5": 0.006536296582799861, "6": 0.18305877230405243, "7": 0.2709815133943956, "8": 0.5313453791278361, "9": 0.3187406907692276}, 
			 "dibke": {"0": 0.7249020218640695, "1": 0.184757167256001, "2": 0.2493752717359522, "3": 0.83473674184466, "4": 0.18315889167544952, "5": 0.9770818905350915, "6": 0.9289967654826475, "7": 0.23822904924893917, "8": 0.2385280318344496, "9": 0.3340194676437963}, "dibya": {"0": 0.07161888071560374, "1": 0.4711098713747578, "2": 0.07754812340182404, "3": 0.23230059403998582, "4": 0.021566261763982686, "5": 0.6623759166678519, "6": 0.44787487914185, "7": 0.8209370535039484, "8": 0.9092512367784198, "9": 0.514487986742914}}
var nodes = [{'category': 'dibya', 'name': "0"},
 {'category': 'alvin', 'name': "1"},
 {'category': 'blake', 'name': "2"},
 {'category': 'alvin', 'name': "3"},
 {'category': 'dibya', 'name': "4"},
 {'category': 'alvin', 'name': "5"},
 {'category': 'dibya', 'name': "6"},
 {'category': 'alvin', 'name': "7"},
 {'category': 'blake', 'name': "8"},
 {'category': 'blake', 'name': "9"}]
 
 var edges = [{'source': 1, 'target': 6, 'thickness': 1},
 {'source': 1, 'target': 4, 'thickness': 10},
 {'source': 5, 'target': 6, 'thickness': 5},
 {'source': 3, 'target': 2, 'thickness': 5},
 {'source': 1, 'target': 4, 'thickness': 7},
 {'source': 1, 'target': 6, 'thickness': 5},
 {'source': 2, 'target': 4, 'thickness': 7},
 {'source': 8, 'target': 2, 'thickness': 1},
 {'source': 7, 'target': 2, 'thickness': 2},
 {'source': 8, 'target': 5, 'thickness': 6},
 {'source': 2, 'target': 6, 'thickness': 9},
 {'source': 5, 'target': 3, 'thickness': 5},
 {'source': 6, 'target': 8, 'thickness': 3},
 {'source': 9, 'target': 6, 'thickness': 8},
 {'source': 9, 'target': 2, 'thickness': 8},
 {'source': 8, 'target': 4, 'thickness': 1},
 {'source': 8, 'target': 2, 'thickness': 5},
 {'source': 2, 'target': 5, 'thickness': 6},
 {'source': 4, 'target': 5, 'thickness': 6},
 {'source': 8, 'target': 6, 'thickness': 1}];
 var colors = {'alvin': [0, 169, 190], 'dibya': [100, 0, 0], 'blake': [50, 70, 150]}

var drawD3Document = function(nodes,links) {
	var WIDTH = $(document).width(), HEIGHT = $(document).height();
    var width = WIDTH, height = HEIGHT;
    var force = d3.layout.force().nodes(d3.values(nodes)).links(links).size([ width, height ]).linkDistance(50).charge(-3000).on("tick", tick);
    var svg = d3.select("#canvas-svg").append("svg").attr("width", width).attr("height", height);
    svg.append("svg:defs").selectAll("marker").data([ "end" ]).enter().append("svg:marker").attr("id", String).attr("viewBox", "0 -5 10 10").attr("refX", 15).attr("refY", -1.5).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("svg:path").attr("d", "M0,-5L10,0L0,5");
    var path = svg.append("svg:g").selectAll("path").data(force.links()).enter().append("svg:path").style('stroke-width',function(d){return d.thickness}).attr("class", "link");

    var node = svg.selectAll(".node").data(force.nodes()).enter().append("g").attr("class", "node").call(force.drag);
    node.append("circle").attr("r", 10);
    node.append("p").attr("x", 12).attr("dy", ".35em").text(function(d) {
        return d.name;
    });
    force.start();
    for (var i = 0; i < 100; ++i) force.tick();
    force.stop();
    function tick() {
        path.attr("d", function(d) {
            var dx = d.target.x - d.source.x, dy = d.target.y - d.source.y, dr = Math.sqrt(dx * dx + dy * dy);
            return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
        });
        node.attr("transform", function(d) {
            return "translate(" + d.x + "," + d.y + ")";
        });
    }
};
//Colors all the nodes based on relationship to category (only one selected) 
var catColorAlpha = function(focusCategory){
	var dict = categories[focusCategory];
	var rgb = colors[focusCategory];
	var rgbaString = "rgba(" + rgb[0] + "," + rgb[1] + "," + rgb[2];
	var colorCalcVert = function(d){
	 // We are going to add alpha in the loop
		for (i = 0; i < 10; i += 1){ // Probably a better way to do this, will revisit. // 
			var strNum = i.toString();
			console.log(strNum);
			if (strNum == d.name){
				rgbaString + "," + dict[strNum] + ")";
				console.log(rgbaString)
				return rgbaString + "," + dict[strNum] + ")";
			}
		}
	}
	var colorCalcEdge = function(d){
		var alpha1 = d.source.name.toString();
		var alpha2 = d.target.name.toString();
		return  rgbaString + "," + Math.max(dict[alpha1], dict[alpha2]);
	}
	var svg = d3.select("#canvas-svg");
	var node = svg.selectAll(".node");
	node.select('circle').style('fill', colorCalcVert);
	node.select('p').style('color',colorCalcVert);
	var edges = svg.selectAll('.link');
	edges.style('stroke', colorCalcEdge);
}
// This will color every vertex by its most related category.
//var eachCatColor = function(){

//}
var catColor = function(focusCategory){
	var rgb = colors[focusCategory]
	var checkVert = function(d){
		if (d.category == focusCategory){
			return "rgb(" + rgb[0] + "," + rgb[1] + "," + rgb[2] + ")"
		return "rgb(230, 230, 230)"
		}
	}
	var checkEdge = function(d){
		if (d.source.category == focusCategory || d.target.category == focusCategory){
			return "rgb(" + rgb[0] + "," + rgb[1] + "," + rgb[2] + ")"
		}
		return "rgb(230, 230, 230)"
			
	}
	focusOn(checkVert, checkEdge);
}
var focusOn = function(f1,f2){
	var svg = d3.select("#canvas-svg");
	var node = svg.selectAll(".node");
	node.select('circle').style('fill', f1);
	node.select('p').style('color',f1);
	var edges = svg.selectAll('.link');
	edges.style('stroke',f2);
}

// Colors vertices and edges based on a specific vertex (non weighted <rgb>)
var focusVertex = function(focusCharacter){
	var fVertex = function(d){
		if(d.name==focusCharacter){
			return "rgb(0,0,0)";
		};	
		return "rgb(230,230,230)";
	};
	var fEdge = function(d){
		if(d.source.name==focusCharacter || d.target.name==focusCharacter){
				return "rgb(0,0,0)";
		};
		return "rgb(230,230,230)";
	};
	focusOn(fVertex,fEdge);
	
};
// Colors vertices and edges based on a category (non weighted <rgb>)
var focusCategory = function(focusCategory){
	var fVertex = function(d){
		if(d.category==focusCategory){
			return "rgb(0,0,0)";
		};
		return "rgb(230,230,230)";
	};
	var fEdge = function(d){
		if(d.source.category==focusCategory || d.target.category==focusCategory){
				return "rgb(0,0,0)";
		};
		return "rgb(230,230,230)";
	};
	focusOn(fVertex,fEdge);
}
</script>
<body onload="drawD3Document(nodes,edges)">
<div id="canvas-svg"></div>
<input id='vtx'>
<button onclick="focusVertex($('#vtx').val())"> HIII </button>
<input id='cat'>
<button onclick="focusCategory($('#cat').val())"> HIII </button>
<input id='colors1'>
<button onclick="catColor($('#colors1').val())"> HIII </button>
</body>

</html>